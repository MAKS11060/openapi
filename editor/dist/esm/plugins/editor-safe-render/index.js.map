{"version":3,"file":"plugins/editor-safe-render/index.js","mappings":"kGACA,IAAIA,EAAsB,CCA1BA,EAAwB,CAACC,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDH,EAAwB,CAACS,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,sBCElF,MAAM,EAFEI,KAAO,IAAIC,EAAI,CAAC,EAAgC,OAA7Bf,EAAoBgB,EAAED,EAAGD,GAAWC,CAAC,EAE3BA,CAAE,CAAE,QAAa,IAAME,EAA+D,UCA3H,MAAM,EAFEH,KAAO,IAAIC,EAAI,CAAC,EAAgC,OAA7Bf,EAAoBgB,EAAED,EAAGD,GAAWC,CAAC,EAE3B,CAAE,CAAE,UAAe,IAAMG,EAAkCC,YCAhG,MAAM,EAFEL,KAAO,IAAIC,EAAI,CAAC,EAAgC,OAA7Bf,EAAoBgB,EAAED,EAAGD,GAAWC,CAAC,EAE3B,CAAE,CAAE,IAAS,IAAMK,EAA0DC,MCClH,MAAMC,UAAsBH,EAAAA,UAG1B,+BAAOI,CAAyBC,GAC9B,MAAO,CAAEC,UAAU,EAAMD,QAC3B,CAEAE,WAAAA,IAAeC,GACbC,SAASD,GACTE,KAAKC,MAAQD,KAAKH,YAAYK,YAChC,CAEAC,iBAAAA,GACE,MAAM,gBAAEC,GAAoBJ,KAAKK,MAEjCL,KAAKM,SAAS,CAAEC,cAAeH,EAAgBI,iBACjD,CAEAC,kBAAAA,CAAmBC,EAAWC,GAC5B,MAAM,gBAAEP,GAAoBJ,KAAKK,MAGjC,KAFgCM,EAAUJ,gBAAkBH,EAAgBI,iBAE9C,OAE9B,MAAMI,EAAW,CAAEL,cAAeH,EAAgBI,iBAE9CG,EAAUf,WACZgB,EAAShB,UAAW,EACpBgB,EAASjB,MAAQ,MAGnBK,KAAKM,SAASM,EAChB,CAEAC,iBAAAA,CAAkBlB,EAAOmB,GACvB,MACEC,IAAI,kBAAEF,IACJb,KAAKK,MAETQ,EAAkBlB,EAAOmB,EAC3B,CAEAE,MAAAA,GACE,MAAM,SAAEpB,EAAQ,MAAED,GAAUK,KAAKC,OAC3B,aAAEgB,EAAY,WAAEC,EAAU,SAAEC,GAAanB,KAAKK,MAEpD,GAAIT,GAAYD,EAAO,CACrB,MAAMyB,EAAoBH,EAAa,YACvC,OAAOI,EAAAA,EAAAA,KAACD,EAAiB,CAACE,KAAMJ,GAClC,CAEA,OAAOC,CACT,EApDI1B,EACGS,aAAe,CAAEN,UAAU,EAAOD,MAAO,KAAMY,cAAe,MAgEvEd,EAAc8B,aAAe,CAC3BL,WAAY,iBACZC,SAAU,MAGZ,UC1DA,EAX6BK,CAACC,EAAUC,IACPrB,IAC7B,MAAM,gBAAED,GAAoBsB,EAG5B,OAAOL,EAAAA,EAAAA,KAAC5B,EAAa,IAAKY,EAAOD,gBAAiBA,GAAmB,EC2CzE,EA3C+BuB,CAACC,EAAO,CAAC,KACtC,MAAMC,EAAkD,oBAAnBD,EAAKE,UACpCC,EAAiB,CAAEC,cAAe,GAAIC,cAAc,GACpDC,EAAUL,EAAwBE,EAAiB,IAAKA,KAAmBH,GAE3EO,EAASA,IAgCN,CA/BkBC,KACvB,MAcMC,EAAsBH,EAAQD,aAChCC,EAAQF,cACR,CAfF,SACA,sBACA,SACA,iBACA,eACA,aACA,mBACA,oBACA,iBACA,cACA,gBACA,cAI+BE,EAAQF,eAEzC,OAAOM,EAAAA,QAAAA,QAAkBC,WAAW,CAClCN,cAAc,EACdD,cAAeK,GACf,EAG6BG,KAAA,CAC/BC,eAAgB,CACdhD,cAAe+B,MAOrB,OAAOK,EAAwBM,IAAeA,CAAM,E","sources":["../webpack/bootstrap","../webpack/runtime/define property getters","../webpack/runtime/hasOwnProperty shorthand","../external module \"swagger-ui-react\"","../external module \"react\"","../external module \"react/jsx-runtime.js\"","plugins/editor-safe-render/components/ErrorBoundary.jsx","plugins/editor-safe-render/wrap-components/ErrorBoundaryWrapper.jsx","plugins/editor-safe-render/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"default\"]: () => __WEBPACK_EXTERNAL_MODULE_swagger_ui_react_ed26f026__[\"default\"] });","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"Component\"]: () => __WEBPACK_EXTERNAL_MODULE_react__.Component });","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"jsx\"]: () => __WEBPACK_EXTERNAL_MODULE_react_jsx_runtime_js_fc12ce1a__.jsx });","import PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\nclass ErrorBoundary extends Component {\n  static defaultState = { hasError: false, error: null, editorContent: null };\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error };\n  }\n\n  constructor(...args) {\n    super(...args);\n    this.state = this.constructor.defaultState;\n  }\n\n  componentDidMount() {\n    const { editorSelectors } = this.props;\n\n    this.setState({ editorContent: editorSelectors.selectContent() });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { editorSelectors } = this.props;\n    const hasEditorContentChanged = prevState.editorContent !== editorSelectors.selectContent();\n\n    if (!hasEditorContentChanged) return;\n\n    const newState = { editorContent: editorSelectors.selectContent() };\n\n    if (prevState.hasError) {\n      newState.hasError = false;\n      newState.error = null;\n    }\n\n    this.setState(newState);\n  }\n\n  componentDidCatch(error, errorInfo) {\n    const {\n      fn: { componentDidCatch },\n    } = this.props;\n\n    componentDidCatch(error, errorInfo);\n  }\n\n  render() {\n    const { hasError, error } = this.state;\n    const { getComponent, targetName, children } = this.props;\n\n    if (hasError && error) {\n      const FallbackComponent = getComponent('Fallback');\n      return <FallbackComponent name={targetName} />;\n    }\n\n    return children;\n  }\n}\nErrorBoundary.propTypes = {\n  targetName: PropTypes.string,\n  getComponent: PropTypes.func.isRequired,\n  fn: PropTypes.shape({\n    componentDidCatch: PropTypes.func.isRequired,\n  }).isRequired,\n  editorSelectors: PropTypes.shape({\n    selectContent: PropTypes.func.isRequired,\n  }).isRequired,\n  children: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.node), PropTypes.node]),\n};\nErrorBoundary.defaultProps = {\n  targetName: 'this component',\n  children: null,\n};\n\nexport default ErrorBoundary;\n","import React from 'react';\n\nimport ErrorBoundary from '../components/ErrorBoundary.jsx';\n\nconst ErrorBoundaryWrapper = (Original, system) => {\n  const ErrorBoundaryOverride = (props) => {\n    const { editorSelectors } = system;\n\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <ErrorBoundary {...props} editorSelectors={editorSelectors} />;\n  };\n\n  return ErrorBoundaryOverride;\n};\n\nexport default ErrorBoundaryWrapper;\n","import SwaggerUI from 'swagger-ui-react';\n\nimport ErrorBoundaryWrapper from './wrap-components/ErrorBoundaryWrapper.jsx';\n\n/**\n * This is special version of SwaggerUI.plugins.SafeRender.\n * In editor context, we want to dismiss the error produced\n * in error boundary if editor content has changed.\n */\nconst EditorSafeRenderPlugin = (opts = {}) => {\n  const isCalledWithGetSystem = typeof opts.getSystem === 'function';\n  const defaultOptions = { componentList: [], fullOverride: false };\n  const options = isCalledWithGetSystem ? defaultOptions : { ...defaultOptions, ...opts };\n\n  const plugin = () => {\n    const safeRenderPlugin = () => {\n      const defaultComponentList = [\n        'TopBar',\n        'SwaggerEditorLayout',\n        'Editor',\n        'TextareaEditor',\n        'MonacoEditor',\n        'EditorPane',\n        'EditorPaneBarTop',\n        'EditorPreviewPane',\n        'ValidationPane',\n        'AlertDialog',\n        'ConfirmDialog',\n        'Dropzone',\n      ];\n      const mergedComponentList = options.fullOverride\n        ? options.componentList\n        : [...defaultComponentList, ...options.componentList];\n\n      return SwaggerUI.plugins.SafeRender({\n        fullOverride: true,\n        componentList: mergedComponentList,\n      });\n    };\n\n    const safeRenderPluginOverride = () => ({\n      wrapComponents: {\n        ErrorBoundary: ErrorBoundaryWrapper,\n      },\n    });\n\n    return [safeRenderPlugin, safeRenderPluginOverride];\n  };\n\n  return isCalledWithGetSystem ? plugin(opts) : plugin;\n};\n\nexport default EditorSafeRenderPlugin;\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","x","d","__WEBPACK_EXTERNAL_MODULE_swagger_ui_react_ed26f026__","__WEBPACK_EXTERNAL_MODULE_react__","Component","__WEBPACK_EXTERNAL_MODULE_react_jsx_runtime_js_fc12ce1a__","jsx","ErrorBoundary","getDerivedStateFromError","error","hasError","constructor","args","super","this","state","defaultState","componentDidMount","editorSelectors","props","setState","editorContent","selectContent","componentDidUpdate","prevProps","prevState","newState","componentDidCatch","errorInfo","fn","render","getComponent","targetName","children","FallbackComponent","_jsx","name","defaultProps","ErrorBoundaryWrapper","Original","system","EditorSafeRenderPlugin","opts","isCalledWithGetSystem","getSystem","defaultOptions","componentList","fullOverride","options","plugin","safeRenderPlugin","mergedComponentList","SwaggerUI","SafeRender","safeRenderPluginOverride","wrapComponents"],"sourceRoot":""}